

## Задача
Написать сервис на Python, который имеет 3 REST ендпоинта:

* получает по HTTP имя CSV-файла (пример файла во вложении) в хранилище и суммирует каждый 10й столбец
* показывает количество задач на вычисление, которые на текущий момент в работе
* принимает ID задачи из п.1 и отображает результат в JSON-формате

Сервис должен поддерживать обработку нескольких задач от одного клиента одновременно.
Сервис должен иметь возможность горизонтально масштабироваться и загружать данные из локального диска.

## Решение
Данный репозиторий содержит файл конфигурации docker-compose.yml

Командой

> docker-compose up --build --scale app=2

докер создаёт горизонтально масштабируемую сеть из двух сервисов app. Всего будет создано 4 контейнера: хранилище, nginx и два flask приложения.

После успешного создания контейнеров, нам будут доступны три эндпоинта в сети docker-compose:

 *  ***/csv_name=<data.csv>***
где *data.csv* - название файла + .csv.
По этому эндпоинту воркер получает файл из хранилища и начинает вычислять сумму каждого 10-го столбца. В ответ пользователь получает ID задачи.

Пример запроса:

```bash
curl http://172.18.0.1/csv_name=data.csv
```

Ответ:

```bash
{
  "Task started, your id": "c7bb2a43f8bc4c83be75cc328db2a49a"
}
```



* ***/storage/get_counter***
Возвращает количество задач на вычисление, которые на текущий момент в работе. Другими словами, количество задач, которые пока не сформировали json-файл и не поместили его в хранилище.

* ***/storage/get_json/<json_uuid>***
где *json_uuid* - уникальный ID, который пользователь получает по экндпоинту */csv_name=<data.csv>* для каждого запроса/вычисления.

Пример запроса:

```bash
curl http://172.18.0.1/storage/get_json/c7bb2a43f8bc4c83be75cc328db2a49a
```

Ответ:

```bash
{\"col0\": 87.23137907254966, \"col10\": 85.5182181544557, \"col20\": 83.50995657165178, \"col30\": 89.80931838670679, \"col40\": 84.0584022355312}
```

## Заключение
Задание выполнено в соответствии с задачей и полностью и выполняет все поставленные задачи. 
При выполнении задания были использованы:  docker image "python:3.8-buster", Python-билиотеки
"certifi=2021.10.8 charset-normalizer=2.0.8 click=8.0.3 Flask=2.0.2 idna=3.3 itsdangerous=2.0.1 Jinja2=3.0.3 MarkupSafe=2.0.1 numpy=1.21.4 pandas=1.3.4 python-dateutil=2.8.2 pytz=2021.3 requests=2.26.0 six=1.16.0 urllib3=1.26.7 Werkzeug=2.0.2
", Docker version 20.10.8, build 3967b7d

### Комментарий
Возможные улучшения сервиса. Для более производительной обработки запросов в очереди на реальном проекте можно использовать *Redis Queue*, а  вычисления сумм в столбцах документа можно распараллелить. Так же во Flask 2.0.x появилась поддержка async функций из *коробки* - тоже хороший вариант.
